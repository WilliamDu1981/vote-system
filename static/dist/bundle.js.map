{"version":3,"sources":["CandidateView.js","main.js","VoteView.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["Vue.component('CandidateView', {\r\n  template: `\r\n    <div class=\"view-container\">\r\n      <validator name=\"form\">\r\n        <form novalidate class=\"panel panel-primary\" @submit.prevent=\"onSubmit\">\r\n          <div class=\"panel-heading\">\r\n            <h4>添加候选人</h4>\r\n          </div>\r\n          <div class=\"panel-body\">\r\n            <div class=\"row\">\r\n              <div class=\"col-md-6 col-md-offset-3\">\r\n                <h5 class=\"margin-top\">姓名</h5>\r\n                <div class=\"input-group margin-top\" style=\"width: 100%;\">\r\n                  <input type=\"text\" \r\n                    name=\"realName\" \r\n                    class=\"form-control\" \r\n                    v-model=\"realName\"\r\n                    v-validate:realName=\"{required:true,minlength:2,maxlength:10}\" \r\n                    placeholder=\"姓名\">\r\n                </div>\r\n                <h5 class=\"margin-top\">口号</h5>\r\n                <div class=\"input-group margin-top\" style=\"width: 100%;\">\r\n                  <input type=\"text\" \r\n                    name=\"slogan\" \r\n                    class=\"form-control\" \r\n                    v-model=\"slogan\"\r\n                    v-validate:slogan=\"{required:true,minlength:2,maxlength:100}\" \r\n                    placeholder=\"口号\">\r\n                </div>\r\n                <h5 class=\"margin-top\">柱状图背景色</h5>\r\n                <div class=\"input-group margin-top\" style=\"width: 100%;\">\r\n                  <input type=\"color\" \r\n                    name=\"color\" \r\n                    class=\"form-control\" \r\n                    v-model=\"color\"\r\n                    placeholder=\"柱状图背景色\">\r\n                </div>\r\n            \r\n                <div class=\"row margin-top\">\r\n                  <div class=\"col-md-6\">\r\n                    <button type=\"submit\" \r\n                      :disabled=\"$form.invalid\" \r\n                      class=\"btn btn-block btn-primary\">立即添加</button>\r\n                  </div>\r\n                  \r\n                  <div class=\"col-md-6\">\r\n                    <button type=\"reset\" class=\"btn btn-block\">重置</button>\r\n                   </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </validator>\r\n    </div> \r\n  `,\r\n  data(){\r\n    return {\r\n      realName: '',\r\n      slogan: '',\r\n      color: ''\r\n    }\r\n  },\r\n  methods: {\r\n    onSubmit(){\r\n      var _this = this;\r\n      var params = {\r\n        realName: this.realName,\r\n        slogan: this.slogan,\r\n        color: this.color\r\n      };\r\n      this.$http.post('/candidate', params)\r\n        .then(function (resp) {\r\n          console.log(resp);\r\n          _this.reset();\r\n          alert('添加候选人成功!');\r\n        })\r\n        .catch(function () {\r\n          alert('添加候选人失败，请重试');\r\n        });\r\n      this.$log('$data');\r\n    },\r\n    reset(){\r\n      this.realName = '';\r\n      this.slogan = '';\r\n      this.color = '';\r\n    }\r\n  }\r\n});\r\n","(function () {\r\n  var router=new VueRouter();\r\n  \r\n  window.addEventListener('DOMContentLoaded',function () {\r\n    router.map({\r\n      '/':{\r\n        name:'vote',\r\n        component:Vue.component('VoteView')\r\n      },\r\n      '/candidate':{\r\n        name:'candidate',\r\n        component:Vue.component('CandidateView')\r\n      }\r\n    });\r\n\r\n    router.start({},'#app');\r\n  });\r\n})();\r\n","Vue.component('VoteView',{\r\n  template:`\r\n    <div class=\"view-container\">\r\n      <div class=\"panel panel-primary\">\r\n         <div class=\"panel-heading\"><h4>投票</h4></div>\r\n         <div class=\"panel-body\">\r\n          <table class=\"table table-bordered table-striped table-hover\">\r\n            <thead>\r\n              <th>姓名</th>\r\n              <th>投票</th>\r\n              <th>票数</th>\r\n              <th>口号</th>\r\n              <th>颜色</th>\r\n              <th>删除</th>\r\n              \r\n            </thead>\r\n            <tr v-for=\"candidate of candidates\">\r\n               <td>{{candidate.realName}}</td>\r\n               <td>\r\n                 <button class=\"btn btn-primary btn-sm\" \r\n                  :disabled=\"disableAllButton\"\r\n                  @click=\"vote(candidate)\">\r\n                    +1\r\n                 </button>\r\n               </td>\r\n               \r\n               <td><strong style=\"font-size: 18px;\">{{candidate.votes}}</strong></td>\r\n\r\n               <td>{{candidate.slogan}}</td>\r\n               <td :style=\"{background:candidate.color}\"></td>\r\n               <td>\r\n                <button class=\"btn btn-danger btn-sm\" @click=\"removeCandidate(candidate)\">删除</button>\r\n               </td>\r\n            </tr>\r\n          </table>\r\n         </div>\r\n         <div class=\"panel-footer\">\r\n          <button class=\"btn btn-danger\" @click=\"resetVotes\">重置所有候选人票数</button>\r\n          </div>\r\n      </div>\r\n    </div>\r\n  `,\r\n  data(){\r\n    return {\r\n      candidates:[],\r\n      disableAllButton:false\r\n    }\r\n  },\r\n  route:{\r\n    data(){\r\n      return this.fetch();\r\n    }\r\n  },\r\n  methods:{\r\n    fetch(){\r\n      return this.$http.get('/candidate')\r\n        .then(function (resp) {\r\n          this.candidates=resp.data;\r\n          return {};\r\n        });\r\n    },\r\n    vote(candidate){\r\n      var _this=this;\r\n\r\n      //点击投票后，禁用所有按钮，以防误点\r\n      this.disableAllButton=true;\r\n\r\n      this.$http.put('/candidate/'+candidate._id+'/vote')\r\n        .then(function (resp) {\r\n          candidate.votes=resp.data.votes;\r\n          setTimeout(function () {\r\n            _this.disableAllButton=false;\r\n          },1000);\r\n        });\r\n    },\r\n    resetVotes(){\r\n      if(confirm('你确定要重置所有票数吗？不可恢复，请谨慎操作。')){\r\n        this.$http.put('/candidate/reset',function () {\r\n          alert('重置成功!');\r\n          this.candidates.forEach(function (item) {\r\n            item.votes=0;\r\n          });\r\n        });\r\n      }\r\n    },\r\n    removeCandidate(candidate){\r\n      if(confirm('你确定要删除此候选人吗？')){\r\n        this.$http.delete('/candidate/'+candidate._id,function () {\r\n          alert('删除成功!');\r\n          this.removeLocal(candidate);\r\n        });\r\n      }\r\n    },\r\n    removeLocal(candidate){\r\n      var index=this.candidates.indexOf(candidate);\r\n      this.candidates.splice(index,1);\r\n    }\r\n  }\r\n});"],"sourceRoot":"/source/"}